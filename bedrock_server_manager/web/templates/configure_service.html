<!-- bedrock-server-manager/bedrock_server_manager/web/templates/configure_service.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ app_name }} - Configure Service</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='image/icon/favicon-96x96.png') }}" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='image/icon/favicon.svg') }}" />
    <link rel="shortcut icon" href="{{ url_for('static', filename='image/icon/favicon.ico') }}" />
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='image/icon/apple-touch-icon.png') }}" />
    <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/buttons.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/forms.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/messages.css') }}">
    <script src="{{ url_for('static', filename='js/utils.js') }}"></script>
    <script src="{{ url_for('static', filename='js/server_actions.js') }}"></script>
    <script src="{{ url_for('static', filename='js/install_config.js') }}"></script>
    <style>
        .validation-error { /* ... */ }
    </style>

<div class="container" data-os="{{ os }}" data-server-name="{{ server_name }}">
    <header class="header">
        <h1>Configure Service: {{ server_name }}</h1>
         {% if new_install %}
            <p class="step-indicator">Step 4 of 4 (New Installation)</p>
         {% endif %}
    </header>

    <div id="status-message-area" class="message-box" style="min-height: 1.5em; margin-top: 10px;"></div>

    {% with messages = get_flashed_messages(with_categories=true) %}
         {% if messages %}
             {% for category, message in messages %}
                 <div class="message-box message-{{ category }}">{{ message }}</div>
             {% endfor %}
         {% endif %}
     {% endwith %}

    <section class="service-config-section">
        {% if os == 'Linux' %}
        <div class="form-group">
            <label for="service-autoupdate" class="form-label">
                <input type="checkbox" id="service-autoupdate" name="autoupdate" class="form-checkbox" {% if autoupdate %}checked{% endif %}>
                Enable Auto-Update on Start
            </label>
            <small>Runs update check when service starts.</small>
        </div>

        <div class="form-group">
            <label for="service-autostart" class="form-label">
                <input type="checkbox" id="service-autostart" name="autostart" class="form-checkbox" {% if autostart %}checked{% endif %}>
                Enable Autostart on Boot (Enable Service)
            </label>
             <small>Starts the server automatically when the system boots.</small>
        </div>

        {% elif os == 'Windows' %}
        <div class="form-group">
             <label for="service-autoupdate" class="form-label">
                <input type="checkbox" id="service-autoupdate" name="autoupdate" class="form-checkbox" {% if autoupdate %}checked{% endif %}>
                 Enable Auto-Update on Start
             </label>
              <small>Checks for updates on server start.</small>
        </div>
        {% else %}
        <p>Service configuration is not applicable or supported on this operating system ({{ os }}).</p>
        {% endif %}
        {% if os == 'Linux' or os == 'Windows' %}
             {% if new_install %}
            <div class="form-group">
                <label for="service-start-server" class="form-label">
                    <input type="checkbox" id="service-start-server" name="start_server" class="form-checkbox">
                    Start Server
                </label>
            </div>
             {% endif %}

            <div style="margin-top: 20px;">
                <button type="button" onclick="saveServiceSettings(this, '{{ server_name }}', '{{ os }}', {{ new_install | tojson }})" class="action-button">Save Service Settings</button>

                 {% if new_install %}
                    <a href="{{ url_for('main_routes.index') }}" class="action-link" style="margin-left: 15px;">Finish / To Main Menu</a>
                {% else %}
                     <a href="{{ url_for('main_routes.advanced_menu_route') }}" class="action-link" style="margin-left: 15px;">Return</a>
                {% endif %}
            </div>

        {% else %}
             <div style="margin-top: 20px;">
                 <a href="{{ url_for('main_routes.advanced_menu_route') }}" class="action-link">Back</a>
             </div>
        {% endif %}

    </section>
</div>
</body>
</html>