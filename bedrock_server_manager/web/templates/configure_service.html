<!-- bedrock-server-manager/bedrock_server_manager/web/templates/configure_service.html -->
{% extends "base.html" %}

{# Set the page title #}
{% block title %}{{ super() }} - Configure Service: {{ server_name }}{% endblock %}

{# Add page-specific JS to the head #}
{% block head_scripts %}
    <script src="{{ url_for('static', filename='js/utils.js') }}" defer></script>
    {# server_actions.js might be needed if saveServiceSettings interacts with it #}
    <script src="{{ url_for('static', filename='js/server_actions.js') }}" defer></script>
    <script src="{{ url_for('static', filename='js/install_config.js') }}" defer></script> {# Keep if saveServiceSettings is here #}
{% endblock %}


{# Main content for this page - add data attributes here if JS needs them at this level #}
{% block content %}
<div data-os="{{ os }}" data-server-name="{{ server_name }}">
    <h2>Configure Service Options</h2>
    <p style="margin-bottom: 15px;">Server: <strong>{{ server_name }}</strong>...</p>
    {# ... status/validation divs ... #}

    <section class="service-config-section">

        {% if os == 'Linux' or os == 'Windows' %} {# Combine Linux/Windows toggles #}

        {# --- Auto-Update Toggle --- #}
        <div class="form-group form-group-toggle-container">
             <div class="form-label-group">
                 <label for="service-autoupdate" class="form-label">Enable Auto-Update on Start:</label>
                 <small class="form-help-text">Checks for updates when the service starts.</small>
             </div>
             <div class="toggle-switch-container">
                <input type="checkbox" id="service-autoupdate" name="autoupdate-cb" class="toggle-input" value="true" {% if autoupdate %}checked{% endif %}>
                <label for="service-autoupdate" class="toggle-switch"></label>
             </div>
              <input type="hidden" name="autoupdate" class="toggle-hidden-false" value="false">
              {# Add validation placeholder if needed #}
              {# <div class="validation-error" data-field="autoupdate" style="grid-column: 1 / -1;"></div> #}
        </div>

        {# --- Auto-Start Toggle --- #}
        {% if os == 'Linux' %} {# Only show Autostart for Linux? Adjust if needed #}
         <div class="form-group form-group-toggle-container">
             <div class="form-label-group">
                 <label for="service-autostart" class="form-label">Enable Autostart on Boot:</label>
                 <small class="form-help-text">Starts the server automatically when the system boots.</small>
             </div>
              <div class="toggle-switch-container">
                <input type="checkbox" id="service-autostart" name="autostart-cb" class="toggle-input" value="true" {% if autostart %}checked{% endif %}>
                <label for="service-autostart" class="toggle-switch"></label>
              </div>
               <input type="hidden" name="autostart" class="toggle-hidden-false" value="false">
         </div>
         {% endif %}


         {# --- Start Server after Save Toggle (New Install Only) --- #}
         {% if new_install %}
         <div class="form-group form-group-toggle-container">
              <div class="form-label-group">
                 <label for="service-start-server" class="form-label">Start Server After Saving?</label>
              </div>
              <div class="toggle-switch-container">
                <input type="checkbox" id="service-start-server" name="start_server" class="toggle-input" value="true"> {# Default off #}
                <label for="service-start-server" class="toggle-switch"></label>
              </div>
               {# No hidden false needed if value="true" is only sent when checked #}
         </div>
         {% endif %}


        <div class="form-actions">
             {# Make Save primary #}
            <button type="button" onclick="saveServiceSettings(this, '{{ server_name }}', '{{ os }}', {{ new_install | tojson }})" class="action-button start-button">Save Service Settings</button> {# Changed class #}
             {# ... rest of actions ... #}
        </div>

        {% else %} {# Unsupported OS #}
        <p>Service configuration is not applicable or supported on this operating system ({{ os }}).</p>
         <div class="form-actions">
             <a href="{{ url_for('main_routes.index') }}" class="main-button">Back</a>
         </div>
        {% endif %}

    </section>
</div>
{% endblock %}