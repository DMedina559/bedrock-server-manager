<!-- bedrock-server-manager/bedrock_server_manager/web/templates/configure_allowlist.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ app_name }} - Configure Allowlist</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/buttons.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/forms.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/messages.css') }}">
    <script src="{{ url_for('static', filename='js/utils.js') }}"></script>
    <script src="{{ url_for('static', filename='js/install_config.js') }}"></script>
    <script src="{{ url_for('static', filename='js/allowlist.js') }}"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Configure Allowlist: {{ server_name }}</h1>
             {% if new_install %}
                <p class="step-indicator">Step 2 of 4 (New Installation)</p>
             {% endif %}
        </header>

        <div id="status-message-area" class="message-box" style="min-height: 1.5em; margin-top: 10px;"></div>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="message-box message-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <section class="allowlist-form-section">
            <div class="form-group">
                <label for="player-names-add" class="form-label">Players to Add (one per line):</label>
                <textarea id="player-names-add" name="player_names_add" class="form-input" rows="5" placeholder="Enter player names to add..."></textarea>
            </div>

            <div class="form-group">
                 <label for="ignore-limit-add" class="form-label">
                     <input type="checkbox" id="ignore-limit-add" name="ignore_limit_add" class="form-checkbox">
                     Ignore Player Limit for players being added
                 </label>
            </div>

            <button type="button" onclick="addAllowlistPlayers(this, '{{ server_name }}')" class="main-button">Add Players</button>

             {% if new_install %}
                <a href="{{ url_for('install_config_routes.configure_permissions_route', server_name=server_name, new_install='True') }}" class="action-link" style="margin-left: 15px;">Skip/Next Step â†’</a>
            {% else %}
                 <a href="{{ url_for('main_routes.advanced_menu_route') }}" class="action-link" style="margin-left: 15px;">Return</a>
            {% endif %}

        </section>

        <section class="current-allowlist-section" style="margin-top: 20px;">
            <h2>Current Allowlist</h2>
            <!-- Added ID to the list for easier JS targeting -->
            <ul id="current-allowlist-display">
                {% for player in existing_players %}
                <li>{{ player.name }} (Ignores Limit: {{ player.ignoresPlayerLimit }})</li>
                {% else %}
                <li id="no-players-message">No players currently in allowlist.</li>
                {% endfor %}
            </ul>
        </section>

    </div>
</body>
</html>