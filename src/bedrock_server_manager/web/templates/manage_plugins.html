{# bedrock_server_manager/web/templates/manage_plugins.html #}
{% extends "base.html" %}

{% block title %}{{ super() }} - Manage Plugins{% endblock %}

{% block head_scripts %}
<script src="{{ url_for('static', filename='js/utils.js') }}" defer></script>
<script src="{{ url_for('static', filename='js/manage_plugins.js') }}" defer></script>
{% endblock %}

{% block content %}
<div class="content-container">
    <header class="page-header">
        <h2>Manage Plugins</h2>
        <p>Enable or disable plugins for the Bedrock Server Manager. Changes apply after a restart.</p>
    </header>

    <div id="plugin-status-message-area" class="message-box is-hidden" role="alert" aria-live="polite">
        <!-- Dynamic status messages will be inserted here by JavaScript -->
    </div>

    <section class="list-section">
        <h3>Available Plugins</h3>
        <!-- The JS will populate this list. The 'item-list' class applies the correct styling. -->
        <ul id="plugin-list" class="item-list">
            <!-- The loader is now the first item in the list -->
            <li id="plugin-loader" class="list-item-status" role="status">
                <div class="loader-container-small">
                    <div class="spinner"></div>
                    <p>Loading plugins...</p>
                </div>
            </li>
        </ul>
    </section>

    <!-- ==========================================================================
        CLIENT-SIDE TEMPLATES (FOR JAVASCRIPT)
    ========================================================================== -->
    <!-- Template for a single plugin item. Cloned and populated by JS. -->
    <template id="plugin-item-template">
        <!-- The <li> is styled by the parent ul.item-list to be a flex container -->
        <li>
            <div class="plugin-details">
                <strong class="plugin-name"></strong> <!-- JS populates name -->
            </div>
            <div class="plugin-controls">
                <!-- This specific structure is required by controls.css for the toggle switch -->
                <label class="toggle-switch-container">
                    <!-- The actual checkbox, visually hidden by the 'toggle-input' class -->
                    <input type="checkbox" class="toggle-input plugin-toggle-switch" data-plugin-id="">
                    <!-- The visual representation of the switch, styled by the '.toggle-switch' class -->
                    <span class="toggle-switch"></span>
                </label>
            </div>
        </li>
    </template>

    <!-- Template for when no plugins are found -->
    <template id="no-plugins-template">
        <!-- This uses the special 'no players' message style from forms.css -->
        <li id="no-players-message">
            No plugins found or available to configure.
        </li>
    </template>

    <!-- Template for when an error occurs -->
    <template id="load-error-template">
        <li class="list-item-error">
            <p>Error loading plugin information. Please check the application logs or try again later.</p>
        </li>
    </template>
</div>

<div class="page-actions">
    <a href="{{ url_for('main_routes.index') }}" class="action-link">
          Back to Dashboard
    </a>
</div>
{% endblock %}

{% block body_scripts %}
{% endblock %}