<!-- bedrock_server_manager//web/templates/login.html -->
{# Extends the base layout template #}
{% extends "base.html" %}

{# --- Page Title Block --- #}
{% block title %}{{ super() }} - Login{% endblock %}

{# --- Head Scripts Block --- #}
{% block head_scripts %}
    {# Standard utils for showStatusMessage and sendServerActionRequest #}
<script src="{{ url_for('static', filename='js/utils.js') }}" defer></script>
    {# New auth.js for handleLoginAttempt #}
<script src="{{ url_for('static', filename='js/auth.js') }}" defer></script>
{% endblock %}


{# --- Main Content Block --- #}
{% block content %}
    {# Wrapper for login form styling and centering (defined in forms.css) #}
<div class="login-wrapper">

    {# Page Heading (Optional, header in base.html might suffice) #}
    <h2 style="text-align: center; margin-bottom: 20px;">Login</h2>

    {# Flash messages area (Included from base.html - displays above this block) #}
    {# Server-side flash messages (e.g., 'Invalid credentials') appear here #}

    {# Login Form #}
    {# Assumes 'form' object (instance of LoginForm) is passed from the Flask route #}
    {# Uses POST method, targets the login route URL #}
    {# Modified for JS handling: removed method and action, added id and onsubmit #}
    <form id="login-form" class="login-form" novalidate onsubmit="return false;">

        {# --- Username Field --- #}
        <div class="form-group">
            {# Render label associated with the username input #}
            {{ form.username.label(class="form-label") }}
            {# Render the username input field #}
            {# Add 'is-invalid' class dynamically if validation errors exist for this field #}
            {{ form.username(class="form-input" + (" is-invalid" if form.username.errors else ""), placeholder="Enter your username", required=True, autofocus=True, autocomplete="username") }}
            {# Display validation errors for the username field #}
            {% if form.username.errors %}
            <ul class="form-error">
                {# Defined in forms.css #}
                {% for error in form.username.errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>

        {# --- Password Field --- #}
        <div class="form-group">
            {# Render label associated with the password input #}
            {{ form.password.label(class="form-label") }}
            {# Render the password input field #}
            {# Add 'is-invalid' class dynamically if errors exist #}
            {{ form.password(class="form-input" + (" is-invalid" if form.password.errors else ""), placeholder="Enter your password", required=True, autocomplete="current-password") }}
            {# Display validation errors for the password field #}
            {% if form.password.errors %}
            <ul class="form-error">
                {% for error in form.password.errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>

        {# --- Submit Button --- #}
        {# Use form-actions and login-actions classes for layout/styling #}
        <div class="form-actions login-actions">
            {# Changed from WTForms submit to a regular button with onclick #}
            <button type="button" onclick="handleLoginAttempt(this)" class="action-button start-button">
                Log In
            </button>
        </div>

    </form> {# --- End Login Form --- #}

</div> {# --- End .login-wrapper --- #}
{% endblock %}

{# --- Optional Body Scripts Block --- #}
{% block body_scripts %}
{#
<script>
    // Example: Add focus to username field if it has errors
    // document.addEventListener('DOMContentLoaded', () => {
    //     const usernameInput = document.getElementById('username'); // Assuming WTForms generates 'username' as ID
    //     if (usernameInput && usernameInput.classList.contains('is-invalid')) {
    //         usernameInput.focus();
    //         usernameInput.select(); // Select existing text if desired
    //     }
    // });
</script> #}
{% endblock %}